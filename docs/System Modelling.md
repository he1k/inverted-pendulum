
#### Motor Dynamics

*Electrical*
$(1)\; u = R i + L \dot{i}+e$ 
$(2)\; e = K_e \dot{\theta}$
$(3)\; u = R i + L \dot{i} + K_e \dot{\theta}$
$(4) \frac{i}{u-e} = \frac{1}{Ls + R} = \frac{1}{R}\frac{1}{\frac{L}{R}s + 1} \Rightarrow \tau_e = \frac{L}{R}\;,\;\omega_e = \frac{R}{L}$

Faulhaber 3863H048CR  $\rightarrow \omega_e = \frac{\pu{2.59 \ohm}}{\pu{708 \micro H}} \approx 3.5 \pu{k rad/s}$
Faulhaber 3890H018CR  $\rightarrow \omega_e = \frac{\pu{0.21 \ohm}}{\pu{60.6 \micro H}} \approx 3.5 \pu{k rad/s}$

*Mechanical*
$(1)\; T_m = K_t i$
$(2)\; T_m = T_L + T_d$
$(3)\; T_{\mu,\theta} = b_{\theta} \dot{\theta} + c_{\theta} \mathrm{sgn}(\dot{\theta})$
$(4)\; T_L = J \ddot{\theta} + T_{\mu,\theta}$
$(5)\;J \ddot{\theta} = T_m - T_d -b_{\theta} \dot{\theta} - c_{\theta} \mathrm{sgn}( \dot{\theta})$



#### Pendulum Dynamics

$(1)\; (I + ml^2) \phi^2 + T_{\mu,\phi} + m g l \sin{\phi} = -m l \ddot{x} \cos{\phi}$
$(2)\; (M + m)\ddot{x} + F_{\mu,x} + m l \ddot{\phi} \cos{\phi} - m l \dot{\phi}^2 \sin{\phi} = F$
$(3)\; T_{\mu,\phi} = b_{\phi} \dot{\phi} + c_{\phi} \mathrm{sgn}(\dot{\phi})$
$(4)\; F_{\mu,x} = b_{x} \dot{x} + c_{x} \mathrm{sgn}(\dot{x})$


#### Coupling
$(1)\; T_d = \frac{r}{N}F$

#### State Space

$x = \begin{bmatrix} \phi \\ \dot{\phi} \\ x \\ \dot{x} \\ \theta \\ \dot{\theta} \\ i \end{bmatrix} \; , \; y = \begin{bmatrix} \phi \\ x \\ \theta \\ i \\ \ddot{x}\end{bmatrix}, u=\ddot{x}$
$\dot{x} = Ax + Bu$
$y = Cx + Du$

$u = r_{\ddot{x}} - \ddot{x}$



#### Measurements
Given the sensors present in the system, the following measurements are directly available:
* Encoder A $\rightarrow$ Pendulum angle $\phi$
* Encoder B $\rightarrow$ Cart position $x$
* Accelerometer $\rightarrow$ Cart acceleration $\ddot{x}$
* Encoder C $\rightarrow$ Motor angle $\theta$
* Current sensor $\rightarrow$ Motor current $i$




| Symbol           | Description                           | Unit             |
| ---------------- | ------------------------------------- | ---------------- |
| $u$              | Armature voltage                      | $\pu{V}$         |
| $i$              | Winding current                       | $\pu{A}$         |
| $e$              | Back electro-motive force             | $\pu{V}$         |
| $R$              | Winding resistance                    | $\pu{\ohm}$      |
| $L$              | Winding inductance                    | $\pu{H}$         |
| $K_e$            | Back EMF constant                     | $\pu{V/rad}$     |
| $\theta$         | Rotor angular position                | $\pu{rad}$       |
| $\dot{\theta}$   | Rotor angular velocity                | $\pu{rad/s}$     |
| $\ddot{\theta}$  | Rotor angular acceleration            |                  |
| $T_m$            | Torque generated by the motor current | $\pu{N m}$       |
| $T_L$            | Load torque                           | $\pu{N m}$       |
| $T_{\mu,\theta}$ | Motor friction torque                 | $\pu{N m}$       |
| $T_d$            | Torque disturbance                    | $\pu{N m}$       |
| $b_{\theta}$     | Motor viscous friction coefficient    | $\pu{N m/rad/s}$ |
| $c_{\theta}$     | Motor dry friction coefficient        | $\pu{N m}$       |


